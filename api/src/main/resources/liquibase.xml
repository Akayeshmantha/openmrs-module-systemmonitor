<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">
	<!-- See http://www.liquibase.org/manual/home#available_database_refactorings 
		for a list of supported elements and attributes -->
	<changeSet id="2016June28-1553" author="k-joseph">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">SELECT COUNT(*) FROM
				scheduler_task_config WHERE schedulable_class =
				'org.openmrs.module.systemmonitor.scheduler.PushMonitoredDataTask';
			</sqlCheck>
		</preConditions>
		<comment>Add Scheduled task for Sending data to the configured DHIS instance every after 4 hours</comment>
		<insert tableName="scheduler_task_config">
			<column name="name" value="Push System Monitored Data to DHIS" />
			<column name="schedulable_class"
				value="org.openmrs.module.systemmonitor.scheduler.PushMonitoredDataTask" />
			<column name="description" value="Scheduled task for Sending data to the configured DHIS instance every after 4 hours" />
			<column name="start_time" value="2016-06-28 08:00:00" />
			<column name="start_time_pattern" value="MM/dd/yyyy HH:mm:ss" />
			<column name="repeat_interval" value="14400" />
			<column name="start_on_startup" value="1" />
			<column name="started" value="1" />
			<column name="created_by" value="1" />
			<column name="date_created" value="2016-06-28 16:40:32" />
			<column name="uuid" value="e87dfe90-3d35-11e6-ac61-9e71128cae77" />
		</insert>
	</changeSet>
	<changeSet id="2016June29-1721" author="k-joseph">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">SELECT COUNT(*) FROM
				scheduler_task_config WHERE schedulable_class =
				'org.openmrs.module.systemmonitor.scheduler.UpdateLocallyStoredDHISMetadataFromRemoteTask';
			</sqlCheck>
		</preConditions>
		<comment>Add Scheduled task for updating DHIS metadata locally from configured remote instance once a day at mid-day</comment>
		<insert tableName="scheduler_task_config">
			<column name="name" value="Update Locally Stored DHIS Metadata" />
			<column name="schedulable_class"
				value="org.openmrs.module.systemmonitor.scheduler.UpdateLocallyStoredDHISMetadataFromRemoteTask" />
			<column name="description" value="Scheduled task for updating DHIS metadata locally from configured remote instance once a day at mid-day" />
			<column name="start_time" value="2016-06-29 12:00:00" />
			<column name="start_time_pattern" value="MM/dd/yyyy HH:mm:ss" />
			<column name="repeat_interval" value="86400" />
			<column name="start_on_startup" value="1" />
			<column name="started" value="1" />
			<column name="created_by" value="1" />
			<column name="date_created" value="2016-06-29 17:20:21" />
			<column name="uuid" value="a790a422-3e08-11e6-ac61-9e71128cae77" />
		</insert>
	</changeSet>
	<changeSet id="2016July13-1722" author="k-joseph">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">SELECT COUNT(*) FROM
				scheduler_task_config WHERE schedulable_class =
				'org.openmrs.module.systemmonitor.scheduler.LocalLogsAndDHISDataCleanerTask';
			</sqlCheck>
		</preConditions>
		<comment>Add Scheduled task for cleaning locally stored logs and dhis data after a period of one month at mid-day</comment>
		<insert tableName="scheduler_task_config">
			<column name="name" value="Clean/Delete Old Local Logs and DHIS Data" />
			<column name="schedulable_class"
				value="org.openmrs.module.systemmonitor.scheduler.LocalLogsAndDHISDataCleanerTask" />
			<column name="description" value="Scheduled task for cleaning/deleting locally stored logs and dhis data" />
			<column name="start_time" value="2016-08-01 12:00:00" />
			<column name="start_time_pattern" value="MM/dd/yyyy HH:mm:ss" />
			<column name="repeat_interval" value="2592000" />
			<column name="start_on_startup" value="1" />
			<column name="started" value="1" />
			<column name="created_by" value="1" />
			<column name="date_created" value="2016-07-12 17:22:45" />
			<column name="uuid" value="A54ABA4C-2999-4F20-A1B5-81E322F1DDF7" />
		</insert>
	</changeSet>
	<changeSet id="2016August18-2122" author="k-joseph">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">SELECT COUNT(*) FROM
				scheduler_task_config WHERE schedulable_class =
				'org.openmrs.module.systemmonitor.scheduler.MemoryAggregationTask';
			</sqlCheck>
		</preConditions>
		<comment>Add Scheduled task logging used memory later to be used in aggregation of it</comment>
		<insert tableName="scheduler_task_config">
			<column name="name" value="Used Memory Aggregation" />
			<column name="schedulable_class"
				value="org.openmrs.module.systemmonitor.scheduler.MemoryAggregationTask" />
			<column name="description" value="Runs every minute to log used memory to a file used when aggregating it" />
			<column name="start_time" value="2016-08-18 21:30:00" />
			<column name="start_time_pattern" value="MM/dd/yyyy HH:mm:ss" />
			<column name="repeat_interval" value="60" />
			<column name="start_on_startup" value="1" />
			<column name="started" value="1" />
			<column name="created_by" value="1" />
			<column name="date_created" value="2016-08-18 21:24:45" />
			<column name="uuid" value="B54ABA4C-0096-4F20-A1B5-81E322F1DDF7" />
		</insert>
	</changeSet>
</databaseChangeLog>